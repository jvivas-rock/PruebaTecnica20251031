<aside
  [class]="'bg-white shadow-lg h-full sidebar-transition flex flex-col ' +
           (isCollapsed ? 'w-16' : 'w-64') +
           (isMobile ? ' fixed left-0 top-0 z-40' : '')"
>
  <!-- Header -->
  <div class="p-4 border-b border-gray-200 flex-shrink-0">
    <div class="flex items-center justify-between">
      <!-- Logo -->
      <div *ngIf="!isCollapsed" class="flex items-center space-x-3">
        <div class="w-8 h-8 bg-gradient-to-r from-primary-500 to-blue-600 rounded-lg flex items-center justify-center">
          <i-lucide name="check-circle" class="w-5 h-5 text-white"></i-lucide>
        </div>
        <div>
          <span class="text-xl font-bold text-gray-800 block">TaskManager</span>
          <span class="text-xs text-gray-500 block">v2.0</span>
        </div>
      </div>

      <!-- Toggle Button -->
      <button
        (click)="toggleCollapse()"
        class="p-2 rounded-lg hover:bg-gray-100 transition-colors text-gray-600 flex-shrink-0"
      >
        <i-lucide
          [name]="isCollapsed ? 'chevron-right' : 'chevron-left'"
          class="w-4 h-4"
        ></i-lucide>
      </button>
    </div>
  </div>

  <!-- User Info -->
  <div *ngIf="!isCollapsed && currentUser" class="p-4 border-b border-gray-200 flex-shrink-0">
    <div class="flex items-center space-x-3">
      <div class="w-10 h-10 bg-gradient-to-r from-primary-500 to-blue-600 rounded-full flex items-center justify-center">
        <span class="text-white font-semibold text-sm">
          {{ userInitials }}
        </span>
      </div>
      <div class="flex-1 min-w-0">
        <p class="text-sm font-medium text-gray-900 truncate">
          {{ currentUser.firstName}} {{ currentUser.lastName }}
        </p>
        <p class="text-xs text-gray-500 truncate">{{ currentUser.email }}</p>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="flex-1 overflow-y-auto p-4">
    <ul class="space-y-1">
      <li *ngFor="let item of menuItems">
        <a
          [routerLink]="item.path"
          routerLinkActive="bg-primary-50 text-primary-600 border-primary-200"
          [class]="'flex items-center px-3 py-3 text-sm font-medium rounded-lg border border-transparent transition-all hover:bg-gray-50 group ' +
                   (isCollapsed ? 'justify-center' : '')"
        >
          <i-lucide
            [name]="item.icon"
            class="w-5 h-5 flex-shrink-0"
            [class.text-primary-600]="item.active"
            [class.text-gray-600]="!item.active"
          ></i-lucide>

          <span *ngIf="!isCollapsed" class="ml-3 flex-1">{{ item.label }}</span>

          <!-- Badge -->
          <span
            *ngIf="!isCollapsed && item.badge"
            class="bg-red-500 text-white text-xs px-2 py-1 rounded-full ml-2"
          >
            {{ item.badge }}
          </span>

          <!-- Tooltip for collapsed state -->
          <div
            *ngIf="isCollapsed"
            class="absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity z-50 whitespace-nowrap"
          >
            {{ item.label }}
            <span *ngIf="item.badge" class="ml-1">({{ item.badge }})</span>
          </div>
        </a>
      </li>
    </ul>

    <!-- Section Separator -->
    <div *ngIf="!isCollapsed" class="mt-6 mb-4">
      <p class="text-xs font-semibold text-gray-500 uppercase tracking-wider px-3">
        Herramientas
      </p>
    </div>

    <!-- Additional Menu Items -->
    <ul class="space-y-1">
      <li>
        <a
          href="#"
          class="flex items-center px-3 py-3 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-50 transition-colors"
          [class.justify-center]="isCollapsed"
        >
          <i-lucide name="settings" class="w-5 h-5"></i-lucide>
          <span *ngIf="!isCollapsed" class="ml-3">Configuración</span>
        </a>
      </li>
      <li>
        <a
          href="#"
          class="flex items-center px-3 py-3 text-sm font-medium text-gray-600 rounded-lg hover:bg-gray-50 transition-colors"
          [class.justify-center]="isCollapsed"
        >
          <i-lucide name="help-circle" class="w-5 h-5"></i-lucide>
          <span *ngIf="!isCollapsed" class="ml-3">Ayuda</span>
        </a>
      </li>
    </ul>
  </nav>

  <!-- Footer -->
  <div class="p-4 border-t border-gray-200 flex-shrink-0">
    <button
      (click)="logout()"
      [class]="'flex items-center w-full px-3 py-2 text-sm font-medium text-red-600 rounded-lg hover:bg-red-50 transition-colors ' +
               (isCollapsed ? 'justify-center' : '')"
    >
      <i-lucide name="log-out" class="w-5 h-5"></i-lucide>
      <span *ngIf="!isCollapsed" class="ml-3">Cerrar Sesión</span>

      <!-- Tooltip for collapsed state -->
      <div
        *ngIf="isCollapsed"
        class="absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity z-50 whitespace-nowrap"
      >
        Cerrar Sesión
      </div>
    </button>
  </div>
</aside>

<!-- Overlay for mobile -->
<div
  *ngIf="isMobile && !isCollapsed"
  class="fixed inset-0 bg-black bg-opacity-50 z-30"
  (click)="toggleCollapse()"
></div>
